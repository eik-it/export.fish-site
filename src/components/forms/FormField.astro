---
/**
 * Reusable form field wrapper with label and error message display
 */
interface Props {
  label: string;
  name: string;
  type?: 'text' | 'email' | 'tel' | 'number' | 'textarea';
  required?: boolean;
  placeholder?: string;
  helpText?: string;
  inputMode?: 'text' | 'email' | 'tel' | 'numeric';
  autocomplete?: string;
  maxlength?: number;
  rows?: number;
}

const {
  label,
  name,
  type = 'text',
  required = false,
  placeholder,
  helpText,
  inputMode,
  autocomplete,
  maxlength,
  rows = 3,
} = Astro.props;

const id = `field-${name}`;
const isTextarea = type === 'textarea';
const inputClasses = "w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-colors";
---

<div class="form-field">
  <label for={id} class="block text-sm font-medium text-gray-700 mb-1">
    {label}
    {required && <span class="text-red-500 ml-1">*</span>}
  </label>

  {isTextarea ? (
    <textarea
      id={id}
      name={name}
      required={required}
      placeholder={placeholder}
      autocomplete={autocomplete}
      maxlength={maxlength}
      rows={rows}
      class={inputClasses}
      aria-describedby={helpText ? `${id}-help` : undefined}
      aria-invalid="false"
    />
  ) : (
    <input
      type={type}
      id={id}
      name={name}
      required={required}
      placeholder={placeholder}
      inputmode={inputMode}
      autocomplete={autocomplete}
      maxlength={maxlength}
      class={inputClasses}
      aria-describedby={helpText ? `${id}-help` : undefined}
      aria-invalid="false"
    />
  )}

  {
    helpText && (
      <p id={`${id}-help`} class="text-sm text-gray-500 mt-1">
        {helpText}
      </p>
    )
  }

  <p
    id={`${id}-error`}
    class="text-sm text-red-600 mt-1 hidden"
    role="alert"
    aria-live="polite"
  >
  </p>
</div>

<style>
  .form-field input.error,
  .form-field textarea.error {
    border-color: #ef4444;
    background-color: #fef2f2;
  }

  .form-field input:focus.error,
  .form-field textarea:focus.error {
    ring-color: #ef4444;
  }
</style>
