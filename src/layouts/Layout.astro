---
import '../styles/global.css';
import { getImage } from 'astro:assets';
import defaultOgImage from '../assets/hero-bg.jpg';

interface Props {
  title: string;
  description?: string;
}

const {
  title,
  description = 'Enkel fangstrapportering for turistfiskebedrifter',
} = Astro.props;

// Generate optimized OG image
const ogImage = await getImage({ src: defaultOgImage, format: 'webp', width: 1200, height: 630 });

const favicon = '/favicon.svg';
const siteUrl = 'https://eksportfiske.no';
const canonicalURL = new URL(Astro.url.pathname, siteUrl).href;
const ogImageURL = new URL(ogImage.src, siteUrl).href;
---

<!doctype html>
<html lang="no">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />
    <meta name="description" content={description} />

    <!-- Canonical URL -->
    <link rel="canonical" href={canonicalURL} />

    <!-- Open Graph -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content={canonicalURL} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={ogImageURL} />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:image:alt" content="export.fish - Fangstrapportering for turistfiske" />
    <meta property="og:image:type" content="image/webp" />
    <meta property="og:site_name" content="Eksportfiske.no" />
    <meta property="og:locale" content="nb_NO" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content={canonicalURL} />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={ogImageURL} />
    <meta name="twitter:image:alt" content="export.fish app for fangstrapportering" />

    <!-- Favicons - ICO first for Google Search -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="48x48" href="/favicon-48x48.png" />
    <link rel="icon" type="image/png" sizes="192x192" href="/favicon-192x192.png" />
    <link rel="icon" type="image/png" sizes="512x512" href="/favicon-512x512.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/svg+xml" href={favicon} />
    <title>{title}</title>

    <!-- Schema.org Structured Data -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "name": "export.fish",
        "applicationCategory": "BusinessApplication",
        "operatingSystem": "Web Browser",
        "offers": {
          "@type": "Offer",
          "price": "0",
          "priceCurrency": "NOK"
        },
        "description": "Lovpålagt fangstrapportering for turistfiskebedrifter og fritidsboligeiere som leier ut hytte med båt. Godkjent av Fiskeridirektoratet. Hjelper tyskere og andre turister med å eksportere fisk fra Norge lovlig.",
        "url": "https://eksportfiske.no",
        "inLanguage": "no",
        "featureList": [
          "Automatisk daglig rapportering til Fiskeridirektoratet",
          "Lovpålagt fangstrapportering for utleie av hytte med båt",
          "Flerspråklig støtte (norsk, engelsk, tysk) - perfekt for tyske turister",
          "Eksportdokumentasjon for turister som skal ta med fisk hjem",
          "PWA - fungerer på alle enheter uten installasjon",
          "Unngå bøter på opptil 50 000 kr"
        ]
      }
    </script>

    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
          {
            "@type": "Question",
            "name": "Er dette virkelig godkjent av Fiskeridirektoratet?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "Ja, export.fish er et godkjent elektronisk rapporteringssystem som fullt ut oppfyller kravene i Forskrift om rapportering av fangst fra turistfiskevirksomhet (2017-07-05-1141). Systemet rapporterer automatisk all nødvendig informasjon til Fiskeridirektoratet på riktig måte."
            }
          },
          {
            "@type": "Question",
            "name": "Hva hvis turistene ikke bruker appen?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "Turistene setter som regel pris på å bruke appen - det er enkelt, det er på deres språk, og det gir dem en oversikt over egen fangst. De fleste turistfiskebedrifter opplever høy bruk når de informerer turistene om appen ved ankomst."
            }
          },
          {
            "@type": "Question",
            "name": "Må turistene installere en app?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "Nei! Export.fish er en progressiv webapp som fungerer direkte i nettleseren. Turistene kan velge å installere den på hjemskjermen for enklere tilgang, men det er helt valgfritt. De trenger bare å åpne lenken du gir dem."
            }
          },
          {
            "@type": "Question",
            "name": "Hvilke språk støttes?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "Appen støtter for øyeblikket norsk, engelsk og tysk. Turistene velger språk automatisk basert på telefonens innstillinger, eller kan bytte manuelt i appen."
            }
          },
          {
            "@type": "Question",
            "name": "Hvordan håndteres personvern?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "Vi tar personvern på alvor. Export.fish samler kun inn den informasjonen som er nødvendig for fangstrapportering i henhold til Fiskeridirektoratets krav. Turistene registrerer bare fangst - ingen personopplysninger utover det som er påkrevd."
            }
          },
          {
            "@type": "Question",
            "name": "Hva koster det?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "Export.fish er for øyeblikket under testing og er helt gratis for tidlige brukere. Du kan teste alle funksjoner uten noen forpliktelser. Vi vil varsle i god tid før eventuell prising introduseres for eksisterende brukere."
            }
          },
          {
            "@type": "Question",
            "name": "Fungerer appen offline?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "Appen krever internettilkobling for å synkronisere data og sende rapporter til Fiskeridirektoratet. Men turistene kan registrere fangst når de har mobildekning - de trenger ikke være på wifi. De fleste registrerer fangsten når de kommer tilbake til brygga eller hytta."
            }
          },
          {
            "@type": "Question",
            "name": "Kan tyskere og andre turister eksportere fisk fra Norge?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "Ja, turister kan eksportere fisk fra Norge dersom de har bodd hos en registrert turistfiskebedrift og fangsten er korrekt rapportert. Export.fish genererer automatisk den nødvendige eksportdokumentasjonen som turistene trenger for å ta med fisken hjem. Uten gyldig dokumentasjon risikerer turistene bøter på 8 000 kr + 200 kr per kg, samt konfiskering av fangsten."
            }
          },
          {
            "@type": "Question",
            "name": "Må jeg registrere meg som turistfiskebedrift hvis jeg leier ut fritidsbolig med båt?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "Ja, hvis du leier ut hytte eller fritidsbolig med båt til gjester som fisker og tar med seg fisk hjem, må du sannsynligvis registrere deg som turistfiskebedrift hos Fiskeridirektoratet. Dette gjelder uansett om det er direkte eller indirekte utleie. Lovpålagt fangstrapportering er obligatorisk, og manglende rapportering kan gi bøter på opptil 50 000 kr."
            }
          }
        ]
      }
    </script>

    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "Eksportfiske.no",
        "url": "https://eksportfiske.no",
        "contactPoint": {
          "@type": "ContactPoint",
          "url": "https://eksportfiske.no/kontakt",
          "contactType": "customer service",
          "availableLanguage": ["Norwegian"]
        }
      }
    </script>
    <!-- Cloudflare Web Analytics -->
    <script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "6674d462a18d4e0bb16ef63c13ace4a9"}'></script>
    <!-- End Cloudflare Web Analytics -->
  </head>
  <body class="bg-gray-50 text-gray-900">
    <!-- Development Banner -->
    <div class="fixed top-0 w-full bg-amber-500 text-amber-950 text-center py-2 px-4 text-sm font-medium z-[60]">
      Under utvikling – produktet er ikke lansert ennå
    </div>
    <!-- Fixed Navigation -->
    <header class="fixed top-10 w-full bg-white/90 backdrop-blur-sm border-b border-gray-200 z-50">
      <nav class="container mx-auto px-4 py-4 flex justify-between items-center">
        <a href="/" class="flex items-center gap-3 group">
          <img src="https://test.export.fish/static/images/logo.png" alt="export.fish logo" class="h-16 w-16 md:h-20 md:w-20 transition-transform group-hover:scale-110" />
          <span class="text-2xl md:text-3xl font-bold text-primary">Eksportfiske</span>
        </a>
        <!-- Mobile menu (hamburger) -->
        <details id="mobile-menu" class="md:hidden relative">
          <summary class="cursor-pointer p-2 list-none flex items-center justify-center">
            <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
            </svg>
          </summary>
          <nav class="absolute right-0 top-full mt-2 flex flex-col p-4 bg-white shadow-lg rounded-lg border border-gray-200 min-w-[200px] divide-y divide-gray-200">
            <a href="/#fordeler" class="text-gray-600 hover:text-primary transition py-3 px-3 hover:bg-gray-50 rounded">Fordeler</a>
            <a href="/#hvordan-virker-det" class="text-gray-600 hover:text-primary transition py-3 px-3 hover:bg-gray-50 rounded">Hvordan virker det?</a>
            <a href="/registrering" class="text-gray-600 hover:text-primary transition py-3 px-3 hover:bg-gray-50 rounded">Turistfiskebedrift?</a>
            <a href="/kontakt" class="text-gray-600 hover:text-primary transition py-3 px-3 hover:bg-gray-50 rounded">Kontakt</a>
          </nav>
        </details>

        <!-- Desktop menu -->
        <div class="hidden md:flex space-x-8">
          <a href="/#fordeler" class="text-gray-600 hover:text-primary transition">Fordeler</a>
          <a href="/#hvordan-virker-det" class="text-gray-600 hover:text-primary transition">Hvordan virker det?</a>
          <a href="/registrering" class="text-gray-600 hover:text-primary transition">Turistfiskebedrift?</a>
          <a href="/kontakt" class="text-gray-600 hover:text-primary transition">Kontakt</a>
        </div>
        <a href="https://test.export.fish" target="_blank" rel="noopener noreferrer" class="hidden md:inline-block bg-primary hover:bg-primary-hover text-white px-6 py-2 rounded-lg transition-colors font-semibold">
          Prøv appen!
        </a>
      </nav>
    </header>
    <slot />
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const details = document.getElementById('mobile-menu');
        const links = details?.querySelectorAll('a');
        links?.forEach(link => {
          link.addEventListener('click', () => {
            details.removeAttribute('open');
          });
        });
      });
    </script>
  </body>
</html>
